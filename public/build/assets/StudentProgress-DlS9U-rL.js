import{a as re,u as te,r as p,j as e,C as ae}from"./app-17JNjqSJ.js";import{A as L}from"./AppLayout-DeHBSdFD.js";import"./file-text-Znh3F_nC.js";import"./chart-column-NFp01_3v.js";import"./book-open-D3qBa7nK.js";import"./graduation-cap-mrkAgQ1z.js";import"./user-CAmUnVMn.js";import"./log-out-Bc-nJCmd.js";import"./menu-BL5-W5Xp.js";const pe=({student:U,results:C={},current_session:Y,admission_session:q})=>{var M,z,G,I;const{user:J}=re(),{showError:le}=te(),r=U||J,[Q,X]=p.useState(!1),[a,$]=p.useState(null),[b,B]=p.useState(""),[F,ne]=p.useState(Y),[E,ce]=p.useState(q);p.useEffect(()=>{var s,n;if(Object.keys(C).length>0){const t=Z(C);$(t),t.terms.length>0&&B(t.terms[0])}else $({terms:[],termData:{},termSessions:{},overallStats:{totalSubjects:((s=r==null?void 0:r.student_subjects)==null?void 0:s.length)||((n=r==null?void 0:r.studentSubjects)==null?void 0:n.length)||0,completedAssessments:0,averageScore:0,totalScore:0}}),X(!1)},[C,r]);const Z=s=>{var V,W;const n=[],t={},i={};Object.entries(s).forEach(([x,v])=>{Object.entries(v).forEach(([m,o])=>{const h=`${x} - ${m}`;n.push(h),t[h]=o||[],i[h]=x})});const d=n.sort((x,v)=>{const[m,o]=x.split(" - "),[h,u]=v.split(" - ");if(m!==h)return m.localeCompare(h);const N={"First Term":1,"Second Term":2,"Third Term":3};return(N[o]||0)-(N[u]||0)}),c={terms:d,termData:{},termSessions:i,overallStats:{totalSubjects:((V=r==null?void 0:r.student_subjects)==null?void 0:V.length)||((W=r==null?void 0:r.studentSubjects)==null?void 0:W.length)||0,completedAssessments:0,averageScore:0,totalScore:0}};let D=0,y=0,w={};return d.forEach(x=>{const v=t[x]||[];let m=0,o=0;const h=v.map(u=>{var K;const N=parseFloat(u.first_ca)||0,H=parseFloat(u.second_ca)||0,R=parseFloat(u.exam_score)||0,g=N+H+R;m+=g,o++,D+=g,y++;const S=((K=u.subject)==null?void 0:K.name)||"Unknown Subject";w[S]||(w[S]=[]),w[S].push({term:x,score:g,grade:_(g)});const se=_(g);return{subject:S,score:g,percentage:g,grade:se,firstCA:N,secondCA:H,exam:R}});c.termData[x]={totalScore:m,average:o>0?parseFloat((m/o).toFixed(2)):0,grade:o>0?ee(m/o):"N/A",subjects:o,subjectBreakdown:h}}),c.overallStats.completedAssessments=y,c.overallStats.totalScore=D,c.overallStats.averageScore=y>0?parseFloat((D/y).toFixed(2)):0,c.subjectTrends=w,c},_=s=>s>=80?"A":s>=70?"B":s>=60?"C":s>=50?"D":s>=40?"E":"F",ee=s=>s>=80?"A":s>=70?"B":s>=60?"C":s>=50?"D":s>=40?"E":"F",T=s=>{switch(s){case"A":return"text-green-800 bg-green-100 border-green-200";case"B":return"text-blue-700 bg-blue-50 border-blue-200";case"C":return"text-yellow-700 bg-yellow-50 border-yellow-200";case"D":return"text-orange-700 bg-orange-50 border-orange-200";case"E":return"text-purple-700 bg-purple-50 border-purple-200";case"F":return"text-red-700 bg-red-50 border-red-200";default:return"text-gray-700 bg-gray-50 border-gray-200"}},O=s=>s>0?"text-green-600":s<0?"text-red-600":"text-gray-600";if(Q)return e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2",style:{borderColor:ae.primary.red}})})});if(!a||a.terms.length===0)return e.jsx(L,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 00-2-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Progress Data Available"}),e.jsx("p",{className:"text-gray-500",children:"Your academic progress will appear here once results are recorded"})]})});const l=b?a.termData[b]:null,P=a.terms.indexOf(b),k=P>0?a.terms[P-1]:null,j=k?a.termData[k]:null,f=j&&l?parseFloat((l.average-j.average).toFixed(2)):0,A=j&&j.average>0?parseFloat((f/j.average*100).toFixed(1)):0;return e.jsx(L,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Academic Progress"}),e.jsx("p",{className:"mt-1 text-lg text-gray-600",children:"Comprehensive academic performance and growth tracking"})]})})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 mb-8 border border-blue-200",children:e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"w-20 h-20 bg-blue-600 rounded-full flex items-center justify-center text-white text-2xl font-bold",children:[(M=r==null?void 0:r.first_name)==null?void 0:M[0],(z=r==null?void 0:r.last_name)==null?void 0:z[0]]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r?`${r.first_name} ${r.last_name}`:"Loading..."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Admission No:"}),e.jsx("span",{className:"text-sm text-gray-900 font-semibold",children:(r==null?void 0:r.admission_number)||"Loading..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Class:"}),e.jsx("span",{className:"text-sm text-gray-900 font-semibold",children:((G=r==null?void 0:r.school_class)==null?void 0:G.name)||((I=r==null?void 0:r.schoolClass)==null?void 0:I.name)||"Loading..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Current Session:"}),e.jsx("span",{className:"text-sm text-gray-900 font-semibold",children:(F==null?void 0:F.name)||"Not Set"})]}),E&&e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Admitted:"}),e.jsx("span",{className:"text-xs text-gray-700",children:E.name})]})]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Select Term:"}),e.jsx("select",{value:b,onChange:s=>B(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:a.terms.map(s=>e.jsx("option",{value:s,children:s},s))})]})}),l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Current Average"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[l.average.toFixed(2),"%"]}),j&&e.jsxs("p",{className:`text-sm ${O(f)} flex items-center mt-1`,children:[f>0?"↗":f<0?"↘":"→",Math.abs(f).toFixed(2),"%",A!==0&&` (${A>0?"+":""}${A.toFixed(1)}%)`," ","from ",k]})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 00-2-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Score"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:l.totalScore.toFixed(2)}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["out of ",l.subjects*100," possible (",(l.totalScore/(l.subjects*100)*100).toFixed(1),"%)"]})]}),e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Subjects"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:l.subjects}),e.jsx("p",{className:"text-sm text-green-600 mt-1",children:"All subjects assessed"})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overall Grade"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:l.grade}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:l.grade==="A"?"Excellent":l.grade==="B"?"Very Good":l.grade==="C"?"Good":l.grade==="D"?"Fair":l.grade==="E"?"Pass":"Needs Improvement"})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})})]}),l&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-8",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Subject Performance - ",b]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.subjectBreakdown.map((s,n)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.subject}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${T(s.grade)}`,children:s.grade})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"1st Test:"}),e.jsxs("span",{className:"font-medium",children:[s.firstCA,"/20"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"2nd Test:"}),e.jsxs("span",{className:"font-medium",children:[s.secondCA,"/20"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Exam:"}),e.jsxs("span",{className:"font-medium",children:[s.exam,"/60"]})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between text-sm font-semibold",children:[e.jsx("span",{className:"text-gray-900",children:"Total:"}),e.jsxs("span",{className:"text-blue-600",children:[s.score,"/100"]})]})})]})]},n))})})]}),a.subjectTrends&&Object.keys(a.subjectTrends).length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-8",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Subject Performance Trends"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track your performance across all subjects over time"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(a.subjectTrends).map(([s,n])=>{if(n.length<2)return null;const t=n[n.length-1],i=n[n.length-2],d=t.score-i.score,c=i.score>0?(d/i.score*100).toFixed(1):0;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${T(t.grade)}`,children:t.grade})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Latest Score:"}),e.jsxs("span",{className:"font-semibold",children:[t.score.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Previous:"}),e.jsxs("span",{className:"text-gray-700",children:[i.score.toFixed(2),"%"]})]}),d!==0&&e.jsxs("div",{className:`flex justify-between items-center pt-1 border-t ${d>0?"text-green-600":"text-red-600"}`,children:[e.jsx("span",{className:"text-xs",children:"Trend:"}),e.jsxs("span",{className:"text-xs font-semibold",children:[d>0?"↗":"↘"," ",Math.abs(d).toFixed(2),"%",c!==0&&` (${d>0?"+":""}${c}%)`]})]})]})]},s)})})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Academic Timeline"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track your academic journey across terms"})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-0.5 bg-gray-300"}),e.jsx("div",{className:"space-y-8",children:a.terms.map((s,n)=>{const t=a.termData[s],i=n>0?n-1:-1,d=i>=0?a.termData[a.terms[i]]:null,c=d&&t.average>0?parseFloat((t.average-d.average).toFixed(2)):null;return e.jsxs("div",{className:"relative flex items-start space-x-4",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${t.average>0?"bg-blue-600 border-blue-600":"bg-gray-300 border-gray-300"} relative z-10`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:s}),a.termSessions[s]&&e.jsx("p",{className:"text-xs text-gray-500",children:a.termSessions[s]})]}),t.average>0&&e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${T(t.grade)}`,children:t.grade})})]}),t.average>0?e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Average:"}),e.jsxs("span",{className:"ml-2 font-semibold text-gray-900",children:[t.average.toFixed(2),"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total Score:"}),e.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:t.totalScore.toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Subjects:"}),e.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:t.subjects})]})]}),c!==null&&d&&e.jsxs("div",{className:`text-xs ${O(c)}`,children:[c>0?"↗":c<0?"↘":"→"," ",Math.abs(c).toFixed(2),"%",c!==0&&` from ${a.terms[i]}`]})]}):e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Results pending"})]})]},s)})})]})})]})]})]})})};export{pe as default};
