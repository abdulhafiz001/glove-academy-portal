import{e as H,r as d,a as W,u as X,j as e,C as x,A as b}from"./app-17JNjqSJ.js";import{A as L}from"./AppLayout-DeHBSdFD.js";import"./file-text-Znh3F_nC.js";import"./chart-column-NFp01_3v.js";import"./book-open-D3qBa7nK.js";import"./graduation-cap-mrkAgQ1z.js";import"./user-CAmUnVMn.js";import"./log-out-Bc-nJCmd.js";import"./menu-BL5-W5Xp.js";const se=({student:I})=>{var A,S,E,D;const{props:F}=H(),[l,u]=d.useState(!1),[G,q]=d.useState(!1),{user:y}=W(),{showError:h,showSuccess:v}=X(),t=I||F.student||y,[n,g]=d.useState({email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||"",address:(t==null?void 0:t.address)||"",parentName:(t==null?void 0:t.parent_name)||"",parentPhone:(t==null?void 0:t.parent_phone)||"",parentEmail:(t==null?void 0:t.parent_email)||""}),[i,P]=d.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[p,C]=d.useState(!1),[k,_]=d.useState(!1),[f,O]=d.useState(null),[j,B]=d.useState(null);d.useEffect(()=>{(async()=>{try{const a=await b.getCurrentAcademicSession(),o=a.data||a;o.session&&O(o.session),o.admission_session&&B(o.admission_session)}catch{}})()},[]);const s=t||y,m={admissionNumber:(s==null?void 0:s.admission_number)||"Loading...",class:((A=s==null?void 0:s.school_class)==null?void 0:A.name)||"Loading...",session:(f==null?void 0:f.name)||"Not Set",dateAdmitted:s!=null&&s.created_at?new Date(s.created_at).toLocaleDateString():"Loading...",admissionSession:(j==null?void 0:j.name)||"N/A",studentId:(s==null?void 0:s.id)||"Loading...",bloodGroup:(s==null?void 0:s.blood_group)||"N/A",genotype:(s==null?void 0:s.genotype)||"N/A",religion:(s==null?void 0:s.religion)||"N/A",stateOfOrigin:(s==null?void 0:s.state_of_origin)||"N/A",lga:(s==null?void 0:s.lga)||"N/A"};d.useEffect(()=>{t&&g({email:t.email||"",phone:t.phone||"",address:t.address||"",parentName:t.parent_name||"",parentPhone:t.parent_phone||"",parentEmail:t.parent_email||""})},[t]);const M=((S=s==null?void 0:s.student_subjects)==null?void 0:S.map(r=>{var a;return(a=r.subject)==null?void 0:a.name}).filter(Boolean))||[],c=r=>{const{name:a,value:o}=r.target;g(w=>({...w,[a]:o}))},N=r=>{const{name:a,value:o}=r.target;P(w=>({...w,[a]:o}))},R=async()=>{var r,a;if(i.newPassword!==i.confirmPassword){h("New passwords do not match");return}if(i.newPassword.length<8){h("New password must be at least 8 characters long");return}try{_(!0),await b.changeStudentPassword({current_password:i.currentPassword,new_password:i.newPassword,confirm_password:i.confirmPassword}),P({currentPassword:"",newPassword:"",confirmPassword:""}),C(!1),v("Password changed successfully!")}catch(o){h(((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||"Failed to change password")}finally{_(!1)}},z=async()=>{var r,a;try{await b.updateStudentProfile({email:n.email,phone:n.phone,address:n.address,parent_phone:n.parentPhone,parent_email:n.parentEmail}),u(!1),v("Profile updated successfully!")}catch(o){h(((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||"Failed to update profile")}},V=()=>{t&&g({email:t.email||"",phone:t.phone||"",address:t.address||"",parentName:t.parent_name||"",parentPhone:t.parent_phone||"",parentEmail:t.parent_email||""}),u(!1)};return G?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2",style:{borderColor:x.primary.red}})})}):e.jsx(L,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Profile"}),e.jsx("p",{className:"text-gray-600",children:"View and manage your personal information"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"h-24 w-24 rounded-full mx-auto flex items-center justify-center text-white text-2xl font-bold",style:{backgroundColor:x.primary.red},children:[(E=s==null?void 0:s.first_name)==null?void 0:E[0],(D=s==null?void 0:s.last_name)==null?void 0:D[0]]}),e.jsxs("h3",{className:"mt-4 text-xl font-semibold text-gray-900",children:[s==null?void 0:s.first_name," ",s==null?void 0:s.last_name]}),e.jsx("p",{className:"text-sm text-gray-500",children:m.admissionNumber}),e.jsx("p",{className:"text-sm font-medium text-indigo-600",children:m.class})]}),e.jsx("div",{className:"mt-6 border-t border-gray-200 pt-6",children:e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Student ID"}),e.jsx("dd",{className:"text-sm text-gray-900",children:m.studentId})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Current Session"}),e.jsx("dd",{className:"text-sm text-gray-900",children:m.session})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Date Admitted"}),e.jsx("dd",{className:"text-sm text-gray-900",children:new Date(m.dateAdmitted).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Blood Group"}),e.jsx("dd",{className:"text-sm text-gray-900",children:m.bloodGroup})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Genotype"}),e.jsx("dd",{className:"text-sm text-gray-900",children:m.genotype})]})]})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Change Password"}),e.jsx("button",{onClick:()=>C(!p),className:"px-4 py-2 text-sm font-medium text-white rounded-md hover:opacity-90 transition-opacity",style:{backgroundColor:x.primary.red},children:p?"Cancel":"Change Password"})]}),p&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Password"}),e.jsx("input",{type:"password",name:"currentPassword",value:i.currentPassword,onChange:N,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter current password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),e.jsx("input",{type:"password",name:"newPassword",value:i.newPassword,onChange:N,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter new password (min 8 characters)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),e.jsx("input",{type:"password",name:"confirmPassword",value:i.confirmPassword,onChange:N,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Confirm new password"})]}),e.jsx("button",{onClick:R,disabled:k,className:"w-full px-4 py-2 text-sm font-medium text-white rounded-md hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",style:{backgroundColor:x.primary.red},children:k?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating..."]}):"Update Password"})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Personal Information"}),l?e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:V,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:z,className:"px-4 py-2 text-sm font-medium text-white rounded-md hover:opacity-90 transition-opacity",style:{backgroundColor:x.primary.red},children:"Save Changes"})]}):e.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 text-sm font-medium text-white rounded-md hover:opacity-90 transition-opacity",style:{backgroundColor:x.primary.red},children:"Edit Profile"})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Basic Information (Read Only)"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:(s==null?void 0:s.first_name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:(s==null?void 0:s.last_name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Middle Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:(s==null?void 0:s.middle_name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Admission Number"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:(s==null?void 0:s.admission_number)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s!=null&&s.date_of_birth?new Date(s.date_of_birth).toLocaleDateString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Gender"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:(s==null?void 0:s.gender)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),l?e.jsx("input",{type:"email",name:"email",value:n.email,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"}):e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:n.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),l?e.jsx("input",{type:"tel",name:"phone",value:n.phone,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"}):e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:n.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),l?e.jsx("textarea",{name:"address",value:n.address,onChange:c,rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"}):e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:n.address||"N/A"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Parent/Guardian Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Parent/Guardian Name"}),l?e.jsx("input",{type:"text",name:"parentName",value:n.parentName,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"}):e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:n.parentName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Parent Phone"}),l?e.jsx("input",{type:"tel",name:"parentPhone",value:n.parentPhone,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"}):e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:n.parentPhone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Parent Email"}),l?e.jsx("input",{type:"email",name:"parentEmail",value:n.parentEmail,onChange:c,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"}):e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:n.parentEmail})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subjects Offered"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:M.map((r,a)=>e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:r},a))})]})]})]})})]})})]})]})})};export{se as default};
